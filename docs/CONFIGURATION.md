# Configuration

← [Back to README](../README.md)

Configuration is managed through `infrastructure/.env`.

## Environment Variables

| Variable | Description | Example |
|----------|-------------|---------|
| `DOMAIN` | Base domain for your installation | `example.com` |
| `DASHBOARD_SUBDOMAIN` | Dashboard subdomain | `dashboard` |
| `API_SUBDOMAIN` | API subdomain | `api` |
| `DATABASE_URL` | PostgreSQL connection string | `postgresql://user:pass@host:port/db` |
| `POSTGRES_PASSWORD` | PostgreSQL password | Generated by installer |
| `JWT_SECRET` | JWT signing secret | Generated by installer |
| `MANAGEMENT_API_KEY` | Management API authentication key | Generated by installer |
| `CLIPROXYAPI_MANAGEMENT_URL` | Internal management API URL | `http://cliproxyapi:8317/v0/management` |
| `TZ` | Server timezone | `UTC` |

## CLIProxyAPIPlus Configuration

CLIProxyAPIPlus configuration lives in `infrastructure/config/config.yaml`. The dashboard provides a structured UI for editing it, but you can also edit the file directly:

```yaml
api-keys:
  - "sk-your-api-key-here"

providers:
  - name: "claude"
    type: "claude"
    # Provider-specific configuration...
  
  - name: "gemini"
    type: "gemini"
    api-key: "YOUR_GEMINI_API_KEY"
    # Provider-specific configuration...
```

## Dashboard Settings

Dashboard-specific settings are managed through the Settings page in the UI:

- User management (admin password)
- Config Sync token management
- Theme preferences

## Config Sync

The dashboard can automatically sync your OpenCode configurations to your local machine using the companion plugin.

### How It Works

1. **Generate a Sync Token**: Navigate to Settings -> Config Sync in the dashboard
2. **Install the Plugin**: Add `opencode-cliproxyapi-sync` to your OpenCode plugins
3. **Configure**: Create `~/.config/opencode-cliproxyapi-sync/config.json` with your dashboard URL and sync token
4. **Auto-Sync**: On every OpenCode startup, the plugin checks for config changes and updates your local `opencode.json` and `oh-my-opencode.json`

### Plugin Installation

```bash
npx opencode install opencode-cliproxyapi-sync
```

Or add manually to your `opencode.json`:

```json
{
  "plugin": [
    "opencode-cliproxyapi-sync",
    "oh-my-opencode@latest"
  ]
}
```

The plugin supports OCX profiles — each profile can have its own sync config.

For full plugin documentation, see [opencode-cliproxyapi-sync](https://github.com/itsmylife44/opencode-cliproxyapi-sync).

## Config Sharing

Share your configuration with others:

- **Publish**: Generate a unique share code (format: `XXXX-XXXX`) for your config
- **Subscribe**: Enter a share code to sync with a publisher's model selection
- **Automatic Sync**: Subscribers see publisher's models on page reload
- **Subscriber Isolation**: Subscribers keep their own MCP servers and plugins
- **Mutual Exclusivity**: Users can be either publisher OR subscriber, not both